window.addEventListener("DOMContentLoaded",function(){$(".gecko-featuredurl-btn").parent().addClass("nav-link")});
var accountIcon=document.querySelector("#accountIcon"),accountDropdown=document.querySelector(".my-account .dropdown-container"),featureList=document.getElementById("feature-list"),featureDropdown=document.querySelector("#feature-list .dropdown-container");window.addEventListener("resize",function(){var e=document.getElementsByClassName("ac_results");for(i=0;i<e.length;i++)e[i].style.display="none"}),document.addEventListener("click",function(e){var t=document.querySelector("#nav-icon"),n=document.querySelector("#menuIcon"),c=document.querySelector("nav.main-nav"),a=n.contains(e.target),o=c.classList.contains("opened"),i=document.querySelectorAll("body form > div");if(a&!o)t.classList.add("open"),c.classList.add("opened"),Array.prototype.forEach.call(i,function(e,t){e.classList.add("no-display")});else{t.classList.remove("open"),c.classList.remove("opened"),Array.prototype.forEach.call(i,function(e,t){e.classList.remove("no-display")});var r=document.querySelectorAll(".sub-nav.active");Array.prototype.forEach.call(r,function(e,t){e.classList.remove("active")})}c.addEventListener("click",function(e){e.stopPropagation()})}),document.addEventListener("click",function(e){featureList.contains(e.target)&!featureDropdown.classList.contains("active")?featureDropdown.classList.add("active"):featureDropdown.classList.remove("active")}),document.addEventListener("click",function(e){accountIcon.contains(e.target)&!accountDropdown.classList.contains("active")?accountDropdown.classList.add("active"):accountDropdown.classList.remove("active")});var accountWrap=accountDropdown.querySelector(".account-wrap");accountWrap.addEventListener("click",function(e){e.stopPropagation()});for(var grabNavLinks=document.querySelectorAll("nav.main-nav .sub-nav-link"),subNavLinks=[].slice.call(grabNavLinks),i=0;i<subNavLinks.length;i++)subNavLinks[i].addEventListener("click",function(){var e=this.getAttribute("data-id");document.querySelector("[data-parent-id='"+e+"']").classList.add("active"),window.scrollTo(0,0)});for(var grabBackLinks=document.querySelectorAll(".back"),backLinks=[].slice.call(grabBackLinks),i=0;i<backLinks.length;i++)backLinks[i].addEventListener("click",function(e){this.parentElement.classList.remove("active"),window.scrollTo(0,0)});
!function(e){e.fn.extend({autocomplete:function(t,a){var n="string"==typeof t;return a=e.extend({},e.Autocompleter.defaults,{url:n?t:null,data:n?null:t,delay:n?e.Autocompleter.defaults.delay:10,max:a&&!a.scroll?10:150},a),a.highlight=a.highlight||function(e){return e},a.formatMatch=a.formatMatch||a.formatItem,this.each(function(){new e.Autocompleter(this,a)})},result:function(e){return this.bind("result",e)},search:function(e){return this.trigger("search",[e])},flushCache:function(){return this.trigger("flushCache")},setOptions:function(e){return this.trigger("setOptions",[e])},unautocomplete:function(){return this.trigger("unautocomplete")}}),e.Autocompleter=function(t,a){function n(){var n=O.selected();if(!n)return!1;var r=n.result;if(x=r,!(r[0].indexOf("relCats")>1)){if(a.multiple){var o=i(C.val());if(o.length>1){var l,s=a.multipleSeparator.length,u=e(t).selection().start,f=0;e.each(o,function(e,t){if(f+=t.length,u<=f)return l=e,!1;f+=s}),o[l]=r,r=o.join(a.multipleSeparator)}r+=a.multipleSeparator}var h=!1,d=!1;if(r[0].indexOf("ac_category")>0&&(h=!0),r[0].indexOf("ac_compare")>0&&(d=!0),h){var m="/"+r[0].substring(r[0].indexOf("url='")+5,r[0].indexOf("'",r[0].indexOf("url='")+5));return r[0]=e("<div/>").html(r[0].substring(r[0].indexOf("ac_category'>")+13,r[0].indexOf("</span>",r[0].indexOf("ac_category>")))).text(),void(window.location=m)}r[0].indexOf("</span>")>-1&&(r[0]=r[0].substring(r[0].indexOf("ac_name'>")+9,r[0].indexOf("</span>",r[0].indexOf("ac_name>")))),d&&(r[0]=r[0].replace(/\s*\(.*\)/g,""),r[0]=r[0].trim(),r+=" (TopCashback Compare)"),C.val(r),c(),C.trigger("result",[n.data,n.value]);document.getElementsByTagName("input");C.next().click()}}function r(e,t){if(p==v.DEL)return void O.hide();var n=C.val();(t||n!=x)&&(x=n,n=o(n),n.length>=a.minChars?(C.addClass(a.loadingClass),a.matchCase||(n=n.toLowerCase()),f(n,u,c)):(d(),O.hide()))}function i(t){return t?a.multiple?e.map(t.split(a.multipleSeparator),function(a){return e.trim(t).length?e.trim(a):null}):[e.trim(t)]:[""]}function o(n){if(!a.multiple)return n;var r=i(n);if(1==r.length)return r[0];var o=e(t).selection().start;return r=i(o==n.length?n:n.replace(n.substring(o),"")),r[r.length-1]}function l(n,r){a.autoFill&&o(C.val()).toLowerCase()==n.toLowerCase()&&p!=v.BACKSPACE&&(C.val(C.val()+r.substring(o(x).length)),e(t).selection(x.length,x.length+r.length))}function s(){clearTimeout(m),m=setTimeout(c,200)}function c(){O.visible();O.hide(),clearTimeout(m),d(),a.mustMatch&&C.search(function(e){if(!e)if(a.multiple){var t=i(C.val()).slice(0,-1);C.val(t.join(a.multipleSeparator)+(t.length?a.multipleSeparator:""))}else C.val(""),C.trigger("result",null)})}function u(e,t){t&&t.length&&w?(d(),O.display(t,e),l(e,t[0].value),O.show()):c()}function f(n,r,i){a.matchCase||(n=n.toLowerCase());var l=b.load(n);if(l&&l.length)r(n,l);else if("string"==typeof a.url&&a.url.length>0){var s={timestamp:+new Date};e.each(a.extraParams,function(e,t){s[e]="function"==typeof t?t():t}),e.ajax({type:"POST",mode:"abort",port:"autocomplete"+t.name,dataType:a.dataType,url:a.url,data:e.extend({q:o(n),limit:a.max},s),success:function(e){var t=a.parse&&a.parse(e)||h(e);b.add(n,t),r(n,t)}})}else O.emptyList(),i(n)}function h(t){for(var n=[],r=t.split("\n"),i=0;i<r.length;i++){var o=e.trim(r[i]);o&&(o=o.split("|"),n[n.length]={data:o,value:o[0],result:a.formatResult&&a.formatResult(o,o[0])||o[0]})}return n}function d(){C.removeClass(a.loadingClass)}var m,p,g,v={UP:38,DOWN:40,DEL:46,TAB:9,RETURN:13,ESC:27,COMMA:188,PAGEUP:33,PAGEDOWN:34,BACKSPACE:8},C=e(t).attr("autocomplete","off").addClass(a.inputClass),x="",b=e.Autocompleter.Cache(a),w=0,T={mouseDownOnSelect:!1},O=e.Autocompleter.Select(a,t,n,T);e(t.form).bind("submit.autocomplete",function(){if(g)return g=!1,!1}),C.bind("keydown.autocomplete",function(t){switch(w=1,p=t.keyCode,t.keyCode){case v.UP:t.preventDefault(),O.visible()?O.prev():r(0,!0);break;case v.DOWN:t.preventDefault(),O.visible()?O.next():r(0,!0);break;case v.PAGEUP:t.preventDefault(),O.visible()?O.pageUp():r(0,!0);break;case v.RETURN:O.selectedTest()&&t.preventDefault(),n();break;case v.PAGEDOWN:t.preventDefault(),O.visible()?O.pageDown():r(0,!0);break;case a.multiple&&","==e.trim(a.multipleSeparator)&&v.COMMA:case v.ESC:n();break;default:clearTimeout(m),m=setTimeout(r,a.delay)}}).focus(function(){w++}).blur(function(){w=0,T.mouseDownOnSelect||s()}).click(function(){w++>1&&!O.visible()&&r(0,!0)}).bind("search",function(){function t(e,t){var n;if(t&&t.length)for(var r=0;r<t.length;r++)if(t[r].result.toLowerCase()==e.toLowerCase()){n=t[r];break}"function"==typeof a?a(n):C.trigger("result",n&&[n.data,n.value])}var a=arguments.length>1?arguments[1]:null;e.each(i(C.val()),function(e,a){f(a,t,t)})}).bind("flushCache",function(){b.flush()}).bind("setOptions",function(){e.extend(a,arguments[1]),"data"in arguments[1]&&b.populate()}).bind("unautocomplete",function(){O.unbind(),C.unbind(),e(t.form).unbind(".autocomplete")})},e.Autocompleter.defaults={inputClass:"ac_input",resultsClass:"ac_results",loadingClass:"ac_loading",minChars:1,delay:400,matchCase:!1,matchSubset:!0,matchContains:!1,cacheLength:10,max:100,mustMatch:!1,extraParams:{},selectFirst:!1,formatItem:function(e){return e[0]},formatMatch:null,autoFill:!1,width:0,marginLeft:0,multiple:!1,multipleSeparator:", ",highlight:function(e,t){return e.replace(new RegExp("(?![^&;]+;)(?!<[^<>]*)("+t.replace(/([\^\$\(\)\[\]\{\}\*\.\+\?\|\\])/gi,"\\$1")+")(?![^<>]*>)(?![^&;]+;)","gi"),"<strong>$1</strong>")},scroll:!0,scrollHeight:180},e.Autocompleter.Cache=function(t){function a(e,a){t.matchCase||(e=e.toLowerCase());var n=e.indexOf(a);return"word"==t.matchContains&&(n=e.toLowerCase().search("\\b"+a.toLowerCase())),-1!=n&&(0==n||t.matchContains)}function n(e,a){l>t.cacheLength&&i(),o[e]||l++,o[e]=a}function r(){if(!t.data)return!1;var a={},r=0;t.url||(t.cacheLength=1),a[""]=[];for(var i=0,o=t.data.length;i<o;i++){var l=t.data[i];l="string"==typeof l?[l]:l;var s=t.formatMatch(l,i+1,t.data.length);if(!1!==s){var c=s.charAt(0).toLowerCase();a[c]||(a[c]=[]);var u={value:s,data:l,result:t.formatResult&&t.formatResult(l)||s};a[c].push(u),r++<t.max&&a[""].push(u)}}e.each(a,function(e,a){t.cacheLength++,n(e,a)})}function i(){o={},l=0}var o={},l=0;return setTimeout(r,25),{flush:i,add:n,populate:r,load:function(n){if(!t.cacheLength||!l)return null;if(!t.url&&t.matchContains){var r=[];for(var i in o)if(i.length>0){var s=o[i];e.each(s,function(e,t){a(t.value,n)&&r.push(t)})}return r}if(o[n])return o[n];if(t.matchSubset)for(var c=n.length-1;c>=t.minChars;c--){var s=o[n.substr(0,c)];if(s){var r=[];return e.each(s,function(e,t){a(t.value,n)&&(r[r.length]=t)}),r}}return null}}},e.Autocompleter.Select=function(t,a,n,r){function i(){C&&(d=e("<div/>").hide().addClass(t.resultsClass).attr("data-localizer","ignore").css("position","absolute").appendTo(document.body),m=e("<ul/>").appendTo(d).mouseover(function(t){o(t).nodeName&&"LI"==o(t).nodeName.toUpperCase()&&(g=e("li",m).removeClass(p.ACTIVE).index(o(t)),e(o(t)).addClass(p.ACTIVE))}).click(function(t){return e(o(t)).addClass(p.ACTIVE),n(),!1}).mousedown(function(){r.mouseDownOnSelect=!0}).mouseup(function(){r.mouseDownOnSelect=!1}),t.width>0&&d.css("width",t.width),t.marginLeft>0&&d.css("margin-left",t.marginLeft),C=!1)}function o(e){for(var t=e.target;t&&"LI"!=t.tagName;)t=t.parentNode;return t||[]}function l(e){f.slice(g,g+1).removeClass(p.ACTIVE),s(e);var a=f.slice(g,g+1);if(a.hasClass("ac_categoryseparator"))return void l(e>0?1:-1);if(a.addClass(p.ACTIVE),t.scroll){var n=0;f.slice(0,g).each(function(){n+=this.offsetHeight}),n+a[0].offsetHeight-m.scrollTop()>m[0].clientHeight?m.scrollTop(n+a[0].offsetHeight-m.innerHeight()):n<m.scrollTop()&&m.scrollTop(n)}}function s(e){g+=e,g<0?g=f.length-1:g>=f.length&&(g=0)}function c(e){return t.max&&t.max<e?t.max:e}function u(){m.empty();for(var a=c(h.length),n=0;n<a;n++)if(h[n]){var r=t.formatItem(h[n].data,n+1,a,h[n].value,v);if(!1!==r){var i=e("<li/>").html(t.highlight(r,v)).addClass(n%2==0?"ac_even":"ac_odd").addClass(r.indexOf("Related Categories")<=0&&r.indexOf("Snap & Save")<=0&&r.indexOf("TopCashback Compare")<=0&&r.indexOf("In-store Cashback")&&r.indexOf("Recommended for you")<=0?"ac_highlight":"ac_categoryseparator").appendTo(m)[0];e.data(i,"ac_data",h[n])}}f=m.find("li"),t.selectFirst&&(f.slice(0,1).addClass(p.ACTIVE),g=0),e.fn.bgiframe&&m.bgiframe()}var f,h,d,m,p={ACTIVE:"ac_over"},g=-1,v="",C=!0;return{display:function(e,t){i(),h=e,v=t,u()},next:function(){l(1)},prev:function(){l(-1)},pageUp:function(){l(0!=g&&g-8<0?-g:-8)},pageDown:function(){l(g!=f.length-1&&g+8>f.length?f.length-1-g:8)},hide:function(){d&&d.hide(),f&&f.removeClass(p.ACTIVE),g=-1},visible:function(){return d&&d.is(":visible")},current:function(){return this.visible()&&(f.filter("."+p.ACTIVE)[0]||t.selectFirst&&f[0])},show:function(){var n=e(a).offset();if(n.left=n.left-10,d.css({width:"string"==typeof t.width||t.width>0?t.width:e(a).width(),top:n.top+a.offsetHeight,left:n.left,margin:"0px 0px 0px"+t.marginLeft+"px"}).show(),t.scroll&&(m.scrollTop(0),m.css({maxHeight:t.scrollHeight,overflow:"auto"}),void 0!==e.browser&&e.browser.msie&&void 0===document.body.style.maxHeight)){var r=0;f.each(function(){r+=this.offsetHeight});var i=r>t.scrollHeight;m.css("height",i?t.scrollHeight:r),i||f.width(m.width()-parseInt(f.css("padding-left"))-parseInt(f.css("padding-right")))}},selected:function(){var t=f&&f.filter("."+p.ACTIVE).removeClass(p.ACTIVE);return t&&t.length&&e.data(t[0],"ac_data")},selectedTest:function(){var t=f&&f.filter("."+p.ACTIVE);return t&&t.length&&e.data(t[0],"ac_data")},emptyList:function(){m&&m.empty()},unbind:function(){d&&d.remove()}}},e.fn.selection=function(e,t){if(void 0!==e)return this.each(function(){if(this.createTextRange){var a=this.createTextRange();void 0===t||e==t?(a.move("character",e),a.select()):(a.collapse(!0),a.moveStart("character",e),a.moveEnd("character",t),a.select())}else this.setSelectionRange?this.setSelectionRange(e,t):this.selectionStart&&(this.selectionStart=e,this.selectionEnd=t)});var a=this[0];if(a.createTextRange){var n=document.selection.createRange(),r=a.value,i=n.text.length;n.text="<->";var o=a.value.indexOf("<->");return a.value=r,this.selection(o,o+i),{start:o,end:o+i}}return void 0!==a.selectionStart?{start:a.selectionStart,end:a.selectionEnd}:void 0}}(jQuery);